# 스위프트 구조체와 열거형

## Swift 구조체와 열거형: 데이터 모델링의 핵심 도구

### 왜 구조체와 열거형을 배워야 할까요?

마치 요리의 재료를 손질하고 분류하듯, 프로그래밍에서도 데이터를 효과적으로 구성하고 관리해야 합니다. Swift의 구조체(Struct)와 열거형(Enum)은 이러한 데이터 모델링의 핵심 도구입니다. 구조체는 관련된 데이터를 하나의 의미 있는 단위로 묶어주고, 열거형은 관련된 값들의 집합을 정의하여 코드의 가독성과 안정성을 높여줍니다.

**구조체와 열거형을 배우는 것은 다음과 같은 이점을 제공합니다:**

* **데이터 구조화:** 관련된 데이터를 하나의 구조체로 묶어 의미 있는 단위로 관리할 수 있습니다. 예를 들어, 사람의 이름, 나이, 주소 등을 하나의 구조체로 표현하여 사람 정보를 효과적으로 관리할 수 있습니다.
* **코드 가독성 향상:** 열거형을 사용하여 관련된 값들을 명확하게 정의하고, 코드에서 의미 있는 이름으로 사용할 수 있습니다. 예를 들어, 요일을 나타내는 값들을 열거형으로 정의하면, 숫자 대신 "월요일", "화요일"과 같은 직관적인 이름을 사용할 수 있습니다.
* **타입 안정성 강화:** 구조체와 열거형은 강력한 타입 시스템을 제공하여 컴파일 시점에 오류를 발견하고 예방할 수 있도록 도와줍니다. 이는 프로그램의 안정성을 높이고, 런타임 오류를 줄이는 데 기여합니다.
* **값 타입의 장점:** 구조체는 값 타입(Value Type)으로 동작하여 데이터 복사 시 안전하고 예측 가능한 동작을 보장합니다. 이는 멀티스레딩 환경에서 발생할 수 있는 문제를 예방하고, 코드의 안정성을 높이는 데 도움을 줍니다.

### 이 강의에서 배우게 될 내용

이번 강의에서는 Swift의 구조체와 열거형에 대해 자세히 알아보고, 실제 코드 예제를 통해 활용 방법을 익힐 것입니다.

**구체적으로 다음과 같은 내용을 다룰 예정입니다:**

1. **구조체:** 구조체의 정의, 프로퍼티, 메서드, 초기화, 접근 제어 등 구조체의 모든 것을 배웁니다.
2. **값 타입 vs. 참조 타입:** 값 타입과 참조 타입의 차이점을 이해하고, 구조체가 값 타입으로 동작하는 방식을 알아봅니다.
3. **구조체와 클래스 선택 기준:** 구조체와 클래스의 장단점을 비교하고, 어떤 상황에서 어떤 타입을 사용해야 하는지 알아봅니다.
4. **열거형:** 열거형의 정의, 케이스, 연관 값, 메서드 등 열거형의 모든 것을 배웁니다.
5. **실습 프로젝트:** 구조체와 열거형을 활용하여 실제 데이터 모델링을 해보는 실습 프로젝트를 진행합니다.

## 스위프트 구조체 (Struct) 개요

구조체는 관련된 데이터를 하나의 의미 있는 단위로 묶어주는 Swift의 기본 구성 요소입니다. 마치 레고 블록을 조립하여 다양한 형태를 만들 듯, 구조체를 활용하여 복잡한 데이터를 체계적으로 표현하고 관리할 수 있습니다. 

**구조체의 특징:**

* **값 타입 (Value Type):** 구조체는 값 타입으로, 변수나 상수에 할당하거나 함수에 전달할 때 값이 복사됩니다. 따라서 원본 데이터에 영향을 주지 않고 독립적으로 변경할 수 있습니다.
* **프로퍼티 (Properties):** 구조체는 프로퍼티를 통해 데이터를 저장합니다. 프로퍼티는 변수 또는 상수로 선언할 수 있으며, 다양한 데이터 타입을 가질 수 있습니다.
* **메서드 (Methods):** 구조체는 메서드를 통해 데이터를 조작하거나 동작을 수행하는 기능을 제공합니다. 메서드는 함수와 유사하지만, 구조체의 인스턴스와 관련된 작업을 수행합니다.
* **초기화 (Initialization):** 구조체는 초기화 과정을 통해 인스턴스를 생성하고, 프로퍼티에 초기 값을 할당합니다.
* **접근 제어 (Access Control):** 구조체의 멤버(프로퍼티, 메서드)에 대한 접근 권한을 제어하여 데이터의 안전성을 보장합니다.

**구조체 예시:**

```swift
struct Person {
    var name: String
    var age: Int
    var address: String

    func introduce() {
        print("안녕하세요, 저는 \(name)이고 \(age)살이며 \(address)에 삽니다.")
    }
}

var person1 = Person(name: "김철수", age: 30, address: "서울시 강남구")
var person2 = person1 // 값 타입: person1의 값이 복사되어 person2에 할당
person2.name = "박영희"
person1.introduce() // 안녕하세요, 저는 김철수이고 30살이며 서울시 강남구에 삽니다.
person2.introduce() // 안녕하세요, 저는 박영희이고 30살이며 서울시 강남구에 삽니다.
```

## 값 타입 (Value Type) vs. 참조 타입 (Reference Type)

Swift의 데이터 타입은 크게 값 타입과 참조 타입으로 나뉩니다.

* **값 타입:** 구조체, 열거형, 튜플 등이 값 타입에 속합니다. 값 타입은 변수나 상수에 할당되거나 함수에 전달될 때 값이 복사됩니다. 따라서 원본 데이터에 영향을 주지 않고 독립적으로 변경할 수 있습니다.
* **참조 타입:** 클래스가 참조 타입에 속합니다. 참조 타입은 변수나 상수에 할당되거나 함수에 전달될 때 참조(메모리 주소)가 복사됩니다. 따라서 여러 변수가 동일한 객체를 참조하며, 한 곳에서 객체를 변경하면 다른 곳에서도 변경된 내용이 반영됩니다.

**값 타입과 참조 타입 비교:**

| 특징 | 값 타입 (구조체, 열거형, 튜플) | 참조 타입 (클래스) |
|---|---|---|
| 데이터 복사 방식 | 값 복사 | 참조 복사 |
| 메모리 할당  | 스택  | 힙  |
| 변경 가능성 | 변경 가능 (mutating 키워드 사용) | 변경 가능 |
| 스레드 안전성 | 높음 | 낮음 |

### 스택과 힙

Swift에서 데이터를 할당하는 메모리 공간은 크게 **Stack**과 **Heap**으로 나뉩니다. 각각의 특징과 용도는 다음과 같습니다.

**Stack (스택)**

* **특징:**
    * **정적 할당:** 컴파일 시점에 크기가 결정됩니다.
    * **빠른 접근 속도:** 메모리의 top에서 데이터를 push/pop하는 방식으로 관리되어 접근 속도가 빠릅니다.
    * **LIFO (후입선출) 구조:** 가장 마지막에 들어온 데이터가 가장 먼저 나갑니다.
    * **제한된 크기:** 메모리 공간이 제한적입니다. (일반적으로 몇 MB 정도)
* **용도:**
    * **값 타입 (Value Type) 저장:** `Int`, `Double`, `Bool`, `struct` 등 값 타입의 데이터를 저장합니다.
    * **함수 호출 정보 저장:** 함수의 매개변수, 지역 변수, 반환 주소 등 함수 호출과 관련된 정보를 저장합니다.

**Heap (힙)**

* **특징:**
    * **동적 할당:** 런타임 시점에 크기가 결정됩니다.
    * **유연한 메모리 관리:** 필요에 따라 메모리를 할당하고 해제할 수 있습니다.
    * **느린 접근 속도:** Stack에 비해 접근 속도가 느립니다.
    * **참조 타입 (Reference Type) 저장:** `class`, `closure`, `function` 등 참조 타입의 데이터를 저장합니다.
* **용도:**
    * **참조 타입 저장:** `class` 인스턴스, 클로저 등 참조 타입 데이터를 저장합니다.
    * **큰 데이터 저장:** Stack에 비해 큰 데이터를 저장할 수 있습니다.
    * **공유 데이터 저장:** 여러 변수가 같은 데이터를 참조할 때 사용됩니다.

**Stack과 Heap의 사용 예시**

```swift
struct Point {
    var x: Int
    var y: Int
}

class Person {
    var name: String
    var age: Int

    init(name: String, age: Int) {
        self.name = name
        self.age = age
    }
}

func someFunction() {
    let point = Point(x: 10, y: 20) // point는 Stack에 할당
    let person = Person(name: "John", age: 30) // person은 Heap에 할당
}
```

위 예시에서 `point`는 `struct` 타입이므로 값 타입이며, Stack에 할당됩니다. 반면에 `person`은 `class` 타입이므로 참조 타입이며, Heap에 할당됩니다. 

**주의 사항**

* Stack Overflow: Stack에 너무 많은 데이터를 할당하려고 하면 Stack Overflow 오류가 발생할 수 있습니다. (예: 재귀 함수의 무한 호출)
* Memory Leak: Heap에 할당된 메모리를 해제하지 않으면 Memory Leak이 발생할 수 있습니다. (예: `class` 인스턴스를 사용 후 해제하지 않음)

**참고 자료**

* [Swift 메모리 구조 정리](https://1000one.tistory.com/65)
* [iOS :: Swift 메모리의 Stack과 Heap 영역 톺아보기](https://shark-sea.kr/entry/iOS-Swift-%EB%A9%94%EB%AA%A8%EB%A6%AC%EC%9D%98-Stack%EA%B3%BC-Heap-%EC%98%81%EC%97%AD-%ED%86%BA%EC%95%84%EB%B3%B4%EA%B8%B0)

## 구조체와 클래스는 언제 사용하는가?

구조체와 클래스는 각각 장단점을 가지고 있으며, 상황에 따라 적절한 타입을 선택해야 합니다.

**구조체 사용 시점:**

* 데이터가 비교적 단순하고, 복잡한 상속 관계가 필요하지 않을 때
* 값 복사를 통해 데이터의 안전성을 보장해야 할 때
* 멀티스레딩 환경에서 안전하게 데이터를 공유해야 할 때

**클래스 사용 시점:**

* 데이터가 복잡하고, 상속이나 다형성을 활용해야 할 때
* 여러 객체가 동일한 데이터를 공유해야 할 때
* 식별성(Identity)이 중요한 경우 (각 객체가 고유한 식별자를 가져야 할 때)

## 열거형 (Enumeration) 개요

열거형은 관련된 값들의 집합을 정의하는 데 사용됩니다. 예를 들어, 요일, 계절, 상태 등을 열거형으로 표현할 수 있습니다. 열거형은 코드의 가독성을 높이고, 타입 안정성을 강화하는 데 도움을 줍니다.

**열거형 예시:**

```swift
enum CompassPoint {
    case north
    case south
    case east
    case west
}

var direction = CompassPoint.north
direction = .south // 축약형으로 사용 가능
```

## 만들어 봅시다

이제까지 배운 내용을 바탕으로 실제 데이터 모델링을 해봅시다. 예를 들어, `Person` 구조체를 사용하여 사람 정보를 관리하고, `Weekday` 열거형을 사용하여 요일을 표현하는 프로그램을 만들어 볼 수 있습니다.

```swift
struct Person {
    let name: String
    let age: Int
    let address: String
}

enum Weekday {
    case monday, tuesday, wednesday, thursday, friday, saturday, sunday
}

let person = Person(name: "John Doe", age: 30, address: "123 Main Street")
let today = Weekday.monday

print("\(person.name) is \(person.age) years old and lives at \(person.address).")
print("Today is \(today).")
```

위 코드를 사용해 사람들을 새롭게 입력받아 추가하고 목록으로 제시하는 SwiftUI 앱을 만들어봅시다.

## 만들어봅시다

class와 struct를 사용해서 다음의 앱을 만들어봅시다. 단, 상속과 프로토콜, 익스텐션을 적극적으로 활용합시다.

1. 넷플릭스, 디즈니+, 애플tv+ 등 다양한 세부목록 제시 가능한 OTT 영상물 주제로 앱을 만들어봅시다.
1. 기왕이면 영화, 드라마 시리즈, 다큐멘터리 등 다양한 미디어 유형과 장르가 담기도록 만듭시다. 여기에서 프로토콜 생각이 나면 좋습니다.
1. SwiftUI로 앱 프로젝트를 생성합니다.
1. 데이터의 구조에 활용한 타입들에 상속을 제외하고 프로토콜, 익스텐션이 활용되도록 합시다.
1. 첫 화면에서는 주제에서 제시하는 목록이 나타나게 합니다.
1. 특정 주제를 선택하면 다음 화면에서 세부 항목들이 나타납니다.
1. 특정 항목을 선택하면 이미지, 이름, 그 밖의 세부정보들이 나타납니다.

* 특정 OTT의 작품 목록과 세부 페이지 내용들을 거의 그대로 하나라도 더 나타나게 해주시면 됩니다.

## 참고자료

The Swift Programming Language (한국어)

- [구조체와 클래스 (Structures and Classes)](https://bbiguduk.github.io/swift-book-korean/documentation/the-swift-programming-language-korean/classesandstructures)
- [열거형 (Enumerations)](https://bbiguduk.github.io/swift-book-korean/documentation/the-swift-programming-language-korean/enumerations)
- [중첩된 타입 (Nested Types)](https://bbiguduk.github.io/swift-book-korean/documentation/the-swift-programming-language-korean/nestedtypes)